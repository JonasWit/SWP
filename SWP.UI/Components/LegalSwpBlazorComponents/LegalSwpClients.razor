@inject GeneralViewModel generalViewModel

<div class="grid-container-main">

    <div class="show-hide first-tab-section"><button class="show-hide-btn show-hide-btn-1 @(showFormVisible ? "button-active" : "")" @onclick="ShowHideForm"><span>Dodaj Nowego Klienta</span></button></div>
    @if (showFormVisible)
    {
        <div class="row-one">
            <RadzenTemplateForm Data="@App.ClientsPage.NewClient" Submit="@(async (CreateClient.Request args) => { await App.ClientsPage.SubmitNewClient(args); })">
                <RadzenFieldset Text="Nowy Klient">
                    <div class="grid-form form">
                        <i class="user-icon"><img src="/Images/icons8-add-user-male-36.png" /></i>
                        <button class="info" @onclick="ShowHideClientFormI"></button>
                        @if (addClientformVisible)
                        {
                            <div class="info-text">
                                <p>Zarządzaj listą swoich klientów. Użyj guzika "Dodaj Nowego Klienta",aby uzupełnić listę kontaktów.</p>
                                <p>Edytuj oraz usuwaj Klientów z głównej listy. Tekst do zupełnienia.</p>
                            </div>
                        }
                        <div id="client-label">
                            <RadzenLabel Text="Nazwa" Style="font-size: 14px; font-weight:bold" />
                        </div>
                        <div id="client-text">
                            <RadzenTextArea Placeholder="Nazwa..." @bind-Value="App.ClientsPage.NewClient.Name" style="width: 100%;" Name="Nazwa" />
                            <RadzenRequiredValidator Component="Nazwa" Text="Name cannot be empty!" tyle="width: 100%;" />
                            <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Nazwa" Style="position: absolute" />
                        </div>
                        <div id="adress-label">
                            <RadzenLabel Text="Adres" Style="font-size: 14px; font-weight:bold" />
                        </div>
                        <div id="adress-text">
                            <RadzenTextArea Placeholder="Adres..." @bind-Value="App.ClientsPage.NewClient.Address" style="width: 100%;" Name="Address" />
                            <RadzenLengthValidator Max="200" Text="Maksymalnie 200 znaków!" Component="Address" Style="position: absolute" />
                        </div>

                        <div id="phone-label">
                            <RadzenLabel Text="Telefon" Style="font-size: 14px; font-weight:bold" />
                        </div>
                        <div id="phone-text">
                            <RadzenTextBox Placeholder="Telefon..." @bind-Value="App.ClientsPage.NewClient.PhoneNumber" style="width: 100%;" Name="PhoneNumber" />
                            <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="PhoneNumber" Style="position: absolute" />
                        </div>

                        <div id="email-label">
                            <RadzenLabel Text="Email" Style="font-size: 14px; font-weight:bold" />
                        </div>
                        <div id="email-text">
                            <RadzenTextBox Placeholder="Adres Email..." @bind-Value="App.ClientsPage.NewClient.Email" style="width: 100%;" Name="Email" />
                            <RadzenRequiredValidator Component="Email" Text="Email address cannot be empty!" Style="position: absolute" />
                            <RadzenEmailValidator Component="Email" Text="Nieprawidłowy adres Email!" />
                            <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Email" Style="position: absolute" />
                        </div>
                        <div id="btn-add-client">
                            <div>
                                <RadzenButton ButtonType="ButtonType.Submit" Icon="save" Text="Dodaj Klienta" ButtonStyle="ButtonStyle.Secondary" />
                            </div>
                        </div>
                    </div>
                </RadzenFieldset>
            </RadzenTemplateForm>



        </div>}





    <div class="show-hide second-tab-section"><button class="show-hide-btn show-hide-btn-1 @(showClientListVisible ? "button-active" : "")" @onclick="ShowHideClientsList"><span>Lista Klientów</span></button></div>
    @if (showClientListVisible)
    {
        <div class="row-one" id="list">
            <div class="client-list">
                <i class="user-icon"><img src="/Images/icons8-reception-36.png" /></i>

                @if (clientListInfoVisible)
                {
                    <div class="info-text">
                        <p>Zarządzaj listą swoich klientów. Użyj guzika "Dodaj Nowego Klienta",aby uzupełnić listę kontaktów.</p>
                        <p>Edytuj oraz usuwaj Klientów z głównej listy. Tekst do zupełnienia.</p>
                    </div>
                }
                <button class="info" @onclick="ShowHideClientI"></button>
                <div class="client-list-table">
                    <RadzenGrid @ref="App.ClientsPage.ClientsGrid" AllowFiltering="true" AllowPaging="true" PageSize="10" AllowSorting="true"
                                Data="@App.Clients" TItem="ClientViewModel" RowUpdate="@App.ClientsPage.OnUpdateClientRow" RowSelect="@(args => App.ClientsPage.ClientSelected(args))">
                        <Columns>
                            <RadzenGridColumn TItem="ClientViewModel" Property="Name" Title="Nazwa" >
                                <EditTemplate Context="client">
                                    <RadzenTextBox @bind-Value="client.Name" Name="Nazwa" />
                                    <RadzenRequiredValidator Text="Nazwa nie może być pusta!" Component="Nazwa" Popup="true" />
                                    <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Nazwa" Popup="true" />
                                </EditTemplate>
                            </RadzenGridColumn>
                            <RadzenGridColumn TItem="ClientViewModel" Property="Address" Title="Adres" >
                                <EditTemplate Context="client">
                                    <RadzenTextBox @bind-Value="client.Address" Name="Adres" />
                                    <RadzenLengthValidator Max="200" Text="Maksymalnie 200 znaków!" Component="Adres" Popup="true" Style="position: absolute" />
                                </EditTemplate>
                            </RadzenGridColumn>
                            <RadzenGridColumn TItem="ClientViewModel" Property="Email" Title="Email">
                                <EditTemplate Context="client">
                                    <RadzenTextBox @bind-Value="client.Email" Name="Email" />
                                    <RadzenEmailValidator Component="Email" Text="Nieprawidłowy adres Email!" Popup="true" />
                                    <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Email" Popup="true" Style="position: absolute" />
                                </EditTemplate>
                            </RadzenGridColumn>
                            <RadzenGridColumn TItem="ClientViewModel" Property="PhoneNumber" Title="Telefon">
                                <EditTemplate Context="client">
                                    <RadzenTextBox @bind-Value="client.PhoneNumber" Name="Telefon" />
                                    <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Telefon" Popup="true" Style="position: absolute" />
                                </EditTemplate>
                            </RadzenGridColumn>

                            <RadzenGridColumn TItem="ClientViewModel" Bubble="false" Filterable="false" Sortable="false" TextAlign="TextAlign.Center">
                                <Template Context="client">
                                    <RadzenButton Icon="edit" Size="ButtonSize.Medium" Click="@(args => App.ClientsPage.EditClientRow(client))">
                                    </RadzenButton>
                                </Template>
                                <EditTemplate Context="client">
                                    <RadzenButton Icon="save" Size="ButtonSize.Medium" Click="@((args) => App.ClientsPage.SaveClientRow(client))">
                                    </RadzenButton>
                                    <RadzenButton Icon="cancel" Size="ButtonSize.Medium" ButtonStyle="ButtonStyle.Success" Click="@((args) => App.ClientsPage.CancelClientEdit(client))">
                                    </RadzenButton>
                                </EditTemplate>
                            </RadzenGridColumn>
                            <RadzenGridColumn TItem="ClientViewModel" Bubble="false" Filterable="false" Sortable="false" TextAlign="TextAlign.Center" >
                                <Template Context="client">
                                    <RadzenButton ButtonStyle="ButtonStyle.Warning" Icon="archive" Size="ButtonSize.Medium" Click="@(async (args) => await App.ClientsPage.ArchivizeClient(client))">
                                    </RadzenButton>
                                </Template>
                                <EditTemplate Context="client">
                                </EditTemplate>
                            </RadzenGridColumn>
                            <RadzenGridColumn TItem="ClientViewModel" Bubble="false" Filterable="false" Sortable="false" TextAlign="TextAlign.Center" >
                                <Template Context="client">
                                    <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="close" Size="ButtonSize.Medium" Click="@(async (args) => await App.ClientsPage.DeleteClientRow(client))">
                                    </RadzenButton>
                                </Template>
                                <EditTemplate Context="client">
                                </EditTemplate>
                            </RadzenGridColumn>
                        </Columns>
                    </RadzenGrid>
                </div>
            </div>

            @if (App.ClientsPage.SelectedClient != null)
            {
                <div class="contact-details">
                    <div><strong>Nazwa:</strong> @App.ClientsPage.SelectedClient.Name</div>
                    <div><strong>Adres:</strong> @App.ClientsPage.SelectedClient.Address</div>
                    <div><strong>Telefon:</strong> @App.ClientsPage.SelectedClient.PhoneNumber</div>
                    <div><strong>Email:</strong> @App.ClientsPage.SelectedClient.Email</div>
                </div>
            }
        </div>
    }



    @if (App.ActiveClientWithData != null)
    {
        <div class="show-hide second-tab-section"><button class="show-hide-btn show-hide-btn-1 @(showContactsListVisible ? "button-active" : "")" @onclick="ShowHideContactsList"><span>Lista Kontaktów</span></button></div>

        @if (showContactsListVisible)
        {
            <div class="row-one">
                <RadzenTemplateForm Data="@App.ClientsPage.NewContact" Submit="@(async (CreateContactPerson.Request args) => { await App.ClientsPage.SubmitNewContact(args); })">
                    <RadzenFieldset Text="Osoba Kontaktowa">
                        <div class="contact-form">

                            <div class="label">
                                <RadzenLabel Text="Imię" Style="font-size: 14px; font-weight:bold" />
                            </div>
                            <div class="text">
                                <RadzenTextArea Placeholder="Imię..." @bind-Value="App.ClientsPage.NewContact.Name" style="width: 100%;" Name="Name" />
                                <RadzenRequiredValidator Component="Name" Text="Name cannot be empty!" style="width: 100%;" />
                                <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Name" Style="position: absolute" />
                            </div>

                            <div class="label">
                                <RadzenLabel Text="Nazwisko" Style="font-size: 14px; font-weight:bold" />
                            </div>
                            <div class="text">
                                <RadzenTextArea Placeholder="Nazwisko..." @bind-Value="App.ClientsPage.NewContact.Surname" style="width: 100%;" Name="Surname" />
                                <RadzenRequiredValidator Component="Surname" Text="Name cannot be empty!" style="width: 100%;" />
                                <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Surname" Style="position: absolute" />
                            </div>

                            <div class="label">
                                <RadzenLabel Text="Adres" Style="font-size: 14px; font-weight:bold" />
                            </div>
                            <div class="text">
                                <RadzenTextArea Placeholder="Adres..." @bind-Value="App.ClientsPage.NewContact.Address" style="width: 100%;" Name="Address" />
                                <RadzenLengthValidator Max="500" Text="Maksymalnie 500 znaków!" Component="Address" Style="position: absolute" />
                            </div>

                        </div>
                        <div class="contact-form">
                            <div class="label">
                                <RadzenLabel Text="Telefon" Style="font-size: 14px; font-weight:bold" />
                            </div>
                            <div class="text">
                                <RadzenTextBox Placeholder="Telefon..." @bind-Value="App.ClientsPage.NewContact.PhoneNumber" style="width: 100%;" Name="PhoneNumber1" />
                                <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="PhoneNumber1" Style="position: absolute" />
                            </div>

                            <div class="label">
                                <RadzenLabel Text="Telefon2" Style="font-size: 14px; font-weight:bold" />
                            </div>
                            <div class="text">
                                <RadzenTextBox Placeholder="Telefon..." @bind-Value="App.ClientsPage.NewContact.AlternativePhoneNumber" style="width: 100%;" Name="PhoneNumber2" />
                                <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="PhoneNumber2" Style="position: absolute" />
                            </div>

                            <div class="label">
                                <RadzenLabel Text="Email" Style="font-size: 14px; font-weight:bold" />
                            </div>
                            <div class="text">
                                <RadzenTextBox Placeholder="Adres Email..." @bind-Value="App.ClientsPage.NewContact.Email" style="width: 100%;" Name="Email" />
                                <RadzenRequiredValidator Component="Email" Text="Email address cannot be empty!" Style="position: absolute" />
                                <RadzenEmailValidator Component="Email" Text="Nieprawidłowy adres Email!" />
                                <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Email" Style="position: absolute" />
                            </div>


                        </div>
                        <div id="btn-add-client">
                            <div>
                                <RadzenButton ButtonType="ButtonType.Submit" Icon="save" Text="Dodaj Klienta" ButtonStyle="ButtonStyle.Secondary" />
                            </div>
                        </div>

                    </RadzenFieldset>
                </RadzenTemplateForm>

                <RadzenGrid @ref="App.ClientsPage.ContactsGrid" AllowFiltering="true" AllowPaging="true" PageSize="10" AllowSorting="true"
                            Data="@App.ActiveClientWithData.ContactPeople" TItem="ContactPersonViewModel" RowUpdate="@App.ClientsPage.OnUpdateContactRow" RowSelect="@(args => App.ClientsPage.ContactSelected(args))">
                    <Columns>
                        <RadzenGridColumn TItem="ContactPersonViewModel" Property="Name" Title="Nazwa" >
                            <EditTemplate Context="contact">
                                <RadzenTextBox @bind-Value="contact.Name" Name="Name" />
                                <RadzenRequiredValidator Text="Inię nie może być puste!" Component="Name" Popup="true" />
                                <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Name" Popup="true" />
                            </EditTemplate>
                        </RadzenGridColumn>

                        <RadzenGridColumn TItem="ContactPersonViewModel" Property="Surname" Title="Nazwisko" >
                            <EditTemplate Context="contact">
                                <RadzenTextBox @bind-Value="contact.Surname" Name="Surname" />
                                <RadzenRequiredValidator Text="Nazwosko nie może być puste!" Component="Surname" Popup="true" />
                                <RadzenLengthValidator Max="50" Text="Maksymalnie 50 znaków!" Component="Surname" Popup="true" />
                            </EditTemplate>
                        </RadzenGridColumn>
                        <RadzenGridColumn TItem="ContactPersonViewModel" Property="Email" Title="Email" Width="100px">
                            <EditTemplate Context="contact">
                                <RadzenTextBox @bind-Value="contact.Email" Name="Nazwa" />
                            </EditTemplate>
                        </RadzenGridColumn>
                        <RadzenGridColumn TItem="ContactPersonViewModel" Property="PhoneNumber" Title="Telefon" >
                            <EditTemplate Context="contact">
                                <RadzenTextBox @bind-Value="contact.PhoneNumber" Name="PhoneNumber" />
                            </EditTemplate>
                        </RadzenGridColumn>
                        <RadzenGridColumn TItem="ContactPersonViewModel" Property="AlternativePhoneNumber" Title="Drugi Telefon" >
                            <EditTemplate Context="contact">
                                <RadzenTextBox @bind-Value="contact.AlternativePhoneNumber" Name="AlternativePhoneNumber" />
                            </EditTemplate>
                        </RadzenGridColumn>
                        <RadzenGridColumn TItem="ContactPersonViewModel" Property="Address" Title="Addres" >
                            <EditTemplate Context="contact">
                                <RadzenTextBox @bind-Value="contact.Address" Name="Address" />
                            </EditTemplate>
                        </RadzenGridColumn>


                        <RadzenGridColumn TItem="ContactPersonViewModel" Bubble="false" Filterable="false" Sortable="false" TextAlign="TextAlign.Center" >
                            <Template Context="c">
                                <RadzenButton Icon="edit" Size="ButtonSize.Medium" Click="@(args => App.ClientsPage.EditContactRow(c))">
                                </RadzenButton>
                            </Template>
                            <EditTemplate Context="c">
                                <RadzenButton Icon="save" Size="ButtonSize.Medium" Click="@((args) => App.ClientsPage.SaveContactRow(c))">
                                </RadzenButton>
                                <RadzenButton Icon="cancel" Size="ButtonSize.Medium" ButtonStyle="ButtonStyle.Success" Click="@((args) => App.ClientsPage.CancelContactEdit(c))">
                                </RadzenButton>
                            </EditTemplate>
                        </RadzenGridColumn>
                        <RadzenGridColumn TItem="ContactPersonViewModel" Bubble="false" Filterable="false" Sortable="false" TextAlign="TextAlign.Center" >
                            <Template Context="c">
                                <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="close" Size="ButtonSize.Medium" Click="@(async (args) => await App.ClientsPage.DeleteContactRow(c))">
                                </RadzenButton>
                            </Template>
                            <EditTemplate Context="client">
                            </EditTemplate>
                        </RadzenGridColumn>
                    </Columns>
                </RadzenGrid>
            </div>
        }
    }

</div>
